var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,i=(e,t,n)=>(l(e,"symbol"!=typeof t?t+"":t,n),n);import{d as o,u,r as c,w as f,p as d,o as h,c as p,a as y,b as g,e as b,N as w,f as v,g as m,h as _,i as j,j as x,I as k,M as T,k as O,l as S,C as z,m as C,n as E,q as $,s as L,t as P,v as I,x as U,y as N,F,z as M,A as R,B as q,D as A,E as D,G as K,S as B,H as G,J as H,K as J,L as V,O as Q}from"./vendor.28c08d1c.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class W{constructor(e){i(this,"name"),this.name=e}toText(){return this.name}}class X{constructor(e,t){i(this,"arg"),i(this,"body"),this.arg=e,this.body=t}toText(){return`λ${this.arg}.${this.body.toText()}`}}class Y{constructor(e,t){i(this,"left"),i(this,"right"),this.left=e,this.right=t}toText(){return`(${this.left.toText()} ${this.right.toText()})`}}function Z(e){switch(e.type){case"single":return new W(e.name);case"abstraction":return new X(e.arg,Z(e.body));case"application":return new Y(Z(e.left),Z(e.right))}throw new TypeError(`Unknown type ${e.type}.`)}class ee{constructor(e,t){i(this,"subject"),i(this,"result"),this.result=e,this.subject=t}done(){return null!=this.subject}}function te(e){if(e instanceof W);else if(e instanceof Y){if(function(e){return e instanceof Y&&e.left instanceof X}(e)){let t=e.left,n=se(t.body,t.arg,e.right);return new ee(n,e)}let t=te(e.left);if(t.done())return new ee(new Y(t.result,e.right),t.subject);let n=te(e.right);if(n.done())return new ee(new Y(e.left,n.result),n.subject)}else if(e instanceof X){let t=te(e.body);if(t.done())return new ee(new X(e.arg,t.result),t.subject)}return new ee(e)}function ne(e){if(e instanceof W)return new Set([e.name]);if(e instanceof Y)return new Set([...ne(e.left),...ne(e.right)]);if(e instanceof X)return new Set([...ne(e.body),e.arg]);throw new TypeError("Unknown term type.")}function re(e){if(e instanceof W)return new Set([e.name]);if(e instanceof Y)return new Set([...re(e.left),...re(e.right)]);if(e instanceof X){let t=re(e.body);return t.delete(e.arg),t}throw new TypeError("Unknown term type.")}function ae(e){let t=ne(e),n=0;for(;;){let e=`v${n}`;if(!t.has(e))return e;n++}}function se(e,t,n){if(e instanceof W)return e.name==t?n:e;if(e instanceof Y)return new Y(se(e.left,t,n),se(e.right,t,n));if(e instanceof X){if(e.arg==t)return e;if(re(n).has(e.arg)){let r=ae(new Y(e,n));return new X(r,se(se(e.body,e.arg,new W(r)),t,n))}return new X(e.arg,se(e.body,t,n))}throw new TypeError("Unknown term type.")}const le=q("a",{href:"#",style:{"text-decoration":"none",color:"inherit"}},"Lambda Calculus",-1),ie=A("Reduct");const oe=o((ue=((e,t)=>{for(var n in t||(t={}))a.call(t,n)&&l(e,n,t[n]);if(r)for(var n of r(t))s.call(t,n)&&l(e,n,t[n]);return e})({},{components:{Icon:k,MathFunction:T,ChevronRight:z,Check:E}}),t(ue,n({setup:async function(e){let t,n;class r{constructor(e,t){var n;i(this,"value"),i(this,"text"),i(this,"subject"),this.value=e,this.text=this.value.toText(),this.subject=null!=(n=null==t?void 0:t.toText())?n:""}}const a=u(),s=c("λx. y"),l=c([]),o=c(null),q=c(""),A=([t,n]=f((async()=>([t,n]=f((()=>fetch("grammar.peggy"))),t=await t,n(),t).text())),t=await t,n(),t),K=d.generate(A);function B(e){o.value=e,q.value=[...re(o.value)].toString()}function G(e){return Z(K.parse(e))}function H(){try{const e=G(`(${s.value})`);l.value.length=0,l.value.push(new r(e)),B(e)}catch(e){return void a.error(e.toString())}}function J(){const e=te(o.value);e.subject?(l.value.push(new r(e.result,e.subject)),B(e.result)):a.info("Reducted to the final.")}return(e,t)=>(h(),p(b(R),null,{default:y((()=>[g(b(w)),g(b(M),{"content-style":"padding: 24px"},{default:y((()=>[g(b(v),{cols:24},{default:y((()=>[g(b(m),{offset:3,span:18},{default:y((()=>[g(b(_),{vertical:"",size:"large"},{default:y((()=>[g(b(j),{subtitle:"λ 演算"},{avatar:y((()=>[g(b(x),null,{default:y((()=>[g(b(k),{size:"16"},{default:y((()=>[g(b(T))])),_:1})])),_:1})])),title:y((()=>[le])),_:1}),g(b(O),{size:"large"},{default:y((()=>[g(b(S),{placeholder:"λ term",value:s.value,"onUpdate:value":t[0]||(t[0]=e=>s.value=e)},{prefix:y((()=>[g(b(x),null,{default:y((()=>[g(b(k),{size:"16"},{default:y((()=>[g(b(z))])),_:1})])),_:1})])),_:1},8,["value"]),g(b(C),{onClick:H},{default:y((()=>[g(b(x),null,{default:y((()=>[g(b(k),{size:"16"},{default:y((()=>[g(b(E))])),_:1})])),_:1})])),_:1})])),_:1}),g(b(_),{size:"large"},{default:y((()=>[o.value?(h(),p(b(_),{key:0,size:"large",vertical:""},{default:y((()=>[g(b($),{label:"Current",value:o.value.toText()},null,8,["value"]),g(b($),{label:"Free Variables",value:q.value},null,8,["value"]),g(b(L),{vertical:"",style:{width:"100%"}},{default:y((()=>[g(b(C),{onClick:J},{default:y((()=>[ie])),_:1})])),_:1})])),_:1})):P("",!0),l.value.length>0?(h(),p(b(I),{key:1},{default:y((()=>[(h(!0),U(F,null,N(l.value,(e=>(h(),p(b(D),{key:e.text,title:e.text,time:e.subject},null,8,["title","time"])))),128))])),_:1})):P("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}}))));var ue;Q(((e,t)=>{for(const[n,r]of t)e[n]=r;return e})(o({setup:e=>(e,t)=>(h(),p(b(V),null,{default:y((()=>[g(b(J),null,{default:y((()=>[g(b(K)),(h(),p(B,null,{default:y((()=>[g(oe)])),fallback:y((()=>[g(b(G),{size:80,id:"loading-spin"})])),_:1})),g(b(H),{right:100})])),_:1})])),_:1}))}),[["__scopeId","data-v-2edb0622"]])).mount("#app");
